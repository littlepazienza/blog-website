<div class="admin-manage-container">
  <!-- Header -->
  <div class="admin-header">
    <div class="header-content">
      <h1>📝 Blog Management</h1>
      <div class="header-actions">
        <button class="btn btn-primary" (click)="createNewBlog()">
          ✨ Create New Post
        </button>
        <button class="btn btn-outline" (click)="logout()">
          🚪 Logout
        </button>
      </div>
    </div>
  </div>

  <!-- Loading State -->
  <div *ngIf="isLoading" class="loading-container">
    <div class="loading-spinner">🔄</div>
    <p>Loading blog posts...</p>
  </div>

  <!-- Error Message -->
  <div *ngIf="errorMessage && !isLoading" class="error-message">
    <i class="error-icon">⚠️</i>
    {{ errorMessage }}
    <button class="btn btn-sm" (click)="loadBlogs()">Try Again</button>
  </div>

  <!-- Blog Posts List -->
  <div *ngIf="!isLoading && !errorMessage" class="blogs-container">
    <div class="blogs-header">
      <h2>All Blog Posts ({{ blogs.length }})</h2>
      <button class="btn btn-secondary" (click)="loadBlogs()">
        🔄 Refresh
      </button>
    </div>

    <!-- Empty State -->
    <div *ngIf="blogs.length === 0" class="empty-state">
      <div class="empty-icon">📝</div>
      <h3>No blog posts yet</h3>
      <p>Create your first blog post to get started!</p>
      <button class="btn btn-primary" (click)="createNewBlog()">
        ✨ Create First Post
      </button>
    </div>

    <!-- Blog Posts Grid -->
    <div *ngIf="blogs.length > 0" class="blogs-grid">
      <div 
        *ngFor="let blog of blogs" 
        class="blog-card"
      >
        <!-- Blog Header -->
        <div class="blog-header">
          <div class="blog-meta">
            <span 
              class="story-tag" 
              [style.background-color]="getStoryTypeColor(blog.story)"
            >
              {{ blog.story }}
            </span>
            <span class="blog-date">{{ formatDate(blog.date) }}</span>
          </div>
          <div class="blog-id">ID: {{ blog._id }}</div>
        </div>

        <!-- Blog Content -->
        <div class="blog-content">
          <h3 class="blog-title">{{ blog.title }}</h3>
          <p class="blog-description">{{ truncateText(blog.text, 120) }}</p>
          
          <!-- Tags -->
          <div *ngIf="blog.tags && blog.tags.length > 0" class="blog-tags">
            <span 
              *ngFor="let tag of blog.tags" 
              class="tag"
            >
              #{{ tag }}
            </span>
          </div>

          <!-- Files -->
          <div *ngIf="blog.files && blog.files.length > 0" class="blog-files">
            <span class="files-indicator">
              📎 {{ blog.files.length }} file{{ blog.files.length > 1 ? 's' : '' }}
            </span>
          </div>
        </div>

        <!-- Blog Actions -->
        <div class="blog-actions">
          <button 
            class="btn btn-primary btn-sm"
            (click)="editBlog(blog)"
          >
            ✏️ Edit
          </button>
          <button 
            class="btn btn-danger btn-sm"
            (click)="confirmDelete(blog)"
          >
            🗑️ Delete
          </button>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Delete Confirmation Modal -->
<div 
  *ngIf="showDeleteModal" 
  class="modal-overlay"
  (click)="cancelDelete()"
>
  <div class="modal-content" (click)="$event.stopPropagation()">
    <div class="modal-header">
      <h3>🗑️ Delete Blog Post</h3>
    </div>
    
    <div class="modal-body">
      <p>Are you sure you want to delete this blog post?</p>
      <div class="blog-preview">
        <strong>{{ blogToDelete?.title }}</strong>
        <br>
        <small>{{ formatDate(blogToDelete?.date || '') }}</small>
      </div>
      <p class="warning-text">⚠️ This action cannot be undone.</p>
    </div>
    
    <div class="modal-actions">
      <button 
        class="btn btn-secondary" 
        (click)="cancelDelete()"
        [disabled]="isDeleting"
      >
        Cancel
      </button>
      <button 
        class="btn btn-danger" 
        (click)="deleteBlog()"
        [disabled]="isDeleting"
      >
        <span *ngIf="!isDeleting">🗑️ Delete</span>
        <span *ngIf="isDeleting">🔄 Deleting...</span>
      </button>
    </div>
  </div>
</div>